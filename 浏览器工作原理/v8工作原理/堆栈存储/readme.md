# JavaScript 内存机制

- 静态语言和动态语言有什么区别
  静态语言：在使用变量前需要确认其数据类型的
  动态语言：在运行过程中需要检查数据类型的语言
  由此看出，运行动态语言的开销就大一些，需要开销去检测数据类型
- JavaScript 是 弱类型动态语言
  - 弱类型：不需要告诉js引擎某个变量的数据类型，就是引擎在运行的时候会自己计算出来
  - 动态：我们可以使用同一个变量保存不同类型的数据

- 代码存储空间、栈空间、堆空间
  - 栈空间：就是调用栈用来存储执行上下文的
  - 堆空间：存储引用类型

```
function foo() {
  var a = '杨宝'
  var b = a
  var c = { name: '杨宝' }
  var d = c
}
foo()
```
- 调用栈
  全局执行上下文 (栈底)
  foo执行上下文
    - 变量环境：c=undefined, d=undefined, b='杨宝', a='杨宝' 
    - 词法环境：
  - 执行到b=a时，此时数据的值都存在栈当中，所以基本数据类型的数据是存储在栈当中的
  - 可当执行到 c = { name: '杨宝' } c为一个引用数据类型
  - 此时的js引擎会专门开辟一个空间来存储引用数据类型，该空间为堆空间
  - 此时的 c 在变量环境(栈空间中)中保存的值，就是该数据在堆中的地址值
  - c具有的是堆空间中该地址所存数据的引用
  - 此时的d也被赋予该地址值
- 那么为什么要将该引用数据类型专门存储在堆中呢
  - 因为 调用栈的空间有限，都存储在栈中会导致栈溢出
  - 把调用栈空间扩大? 行不通，会让执行上下文的切换效率降低，大大影响代码的执行效率


- 产生闭包
  1. 需要预扫描内部函数
  2. 把内部函数引用的外部变量保存到堆空间中
