# URL到页面渲染
掘金文章解析：https://juejin.cn/post/6844903784229896199

## 整体过程
  1. 浏览器分析该 url 链接
  2. 之后再向 DNS 请求解析该 url 的 IP 地址
  3. 域名系统 DNS 解析出 IP 地址的服务器
  4. 三次握手 浏览器 与 该服务器 建立 TCP 连接 (默认端口号为80)
  5. 浏览器发出 HTTP 请求 若请求 HTML 文件
  6. 服务器通过 HTTP 响应把 HTML 文件发送浏览器
  7. 释放 TCP 连接
  8. 浏览器开始解释 HTML 文件，并将 Web 页显示给用户

## URL
- URL（Uniform Resource Locator），统一资源定位符，用于定位互联网上资源，俗称网址。
格式：scheme: // host.domain:port / path / filename ? abc = 123 #  456789

## 定位到该url所在的IP地址
- 浏览器向DNS服务器发起DNS查询
  1. 客户端 向 本地域名服务器 发出 DNS 请求报文 (递归查询)

  2. 本地域名服务器 收到请求后，查询本地缓存，若没有记录，则以 DNS 客户的身份向 根域名服务器 发出解析请求报文 (迭代查询)

  3. 根域名服务器 收到请求后 判断该域名属于什么域，将对应的 顶级域名服务器 的 IP 地址返回给 本地域名服务器

  4. 本地域名服务器 向 顶级域名服务器 发起解析请求报文 (迭代查询)

  5. 顶级域名服务器 收到请求后，判断该域名属于什么域，因此将对应的 授权域名服务器 的 IP地址 返回给 本地域名服务器

  6. 本地域名服务器 向 授权域名服务器 发起请求解析报文 (迭代查询)

  7. 授权域名服务器 接收到请求后 将查询结果返回给 本地域名服务器

  8. 本地域名服务器 将查询结果保存到 本地缓存 ，同时返回给 客户机

  为了提高 DNS 查询效率：
  减少查询报文数量；
  在 域名服务器 中广泛地使用高速缓存

## 浏览器接收到html文件
- 浏览器对数据包进行词法分析 --> 字符串分成一段一段，对其进行标记，读取这些标记的字符串 --标记--> node结点(a/p/div等标签节点) --> 根据node节点的联系，构成一个DOM树

## 浏览器接收到CSS
步骤同上分析CSS --> CSSOM树
递归CSSOM树确定具体的元素到底是什么样式

## 生成渲染树
DOM树 + CSSOM树 = render树(渲染)

渲染树只包括需要显示的节点

## 回流 （根据渲染树，GPU来绘制页面布局）
浏览器的渲染引擎 每个渲染引擎的执行是一个线程

## 为什么操作DOM性能很差？
js操作DOM结构时 
1. 会出现浏览器的渲染引擎和js执行引擎两个引擎进行同时工作，两个线程需要保持通信，同时工作，多线程并行操作导致性能消耗过大；
2. 可能引起 重绘 和 回流

### 一次性插入一万个DOM操作怎么保证不卡顿
- 懒加载
- 虚拟滚动

## 什么情况下会阻塞渲染
html 与 CSS 本身就会阻塞渲染
script 标签会阻塞代码

## 重绘和回流
回流：节点的几何布局、元素属性发生变化
重绘：节点更改不影响布局的东西
回流一定会重绘，重绘不一定会回流

会导致性能为问题的操作：
1. 改变window大小(导致回流)
2. 改变字体大小(导致回流)
3. display: none (消失到隐藏会导致回流)
4. 设置节点信息的几个方法、offsetTop等都会引发回流

## 减少代码中的回流和重绘：
1. 用 visibility(引发重绘) 代替 display: none(引发回流)
2. 不要把节点的属性值放在一个循环里面当成循环的变量
3. 尽量不要使用table布局
